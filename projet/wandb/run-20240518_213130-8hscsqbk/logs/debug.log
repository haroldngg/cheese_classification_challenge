2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Current SDK version is 0.17.0
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Configure stats pid to 491237
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Loading settings from /users/eleves-a/2022/noam-joud-harold.ngoupeyou/.config/wandb/settings
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Loading settings from /Data/harold.ngoupeyou/cheese_classification_challenge/outputs/train/2024-05-18_21-31-29/wandb/settings
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'project': 'challenge_cheese', 'entity': 'haroldng', 'root_dir': '/Data/harold.ngoupeyou/cheese_classification_challenge', 'sweep_id': 'x13yps6n', 'run_id': '8hscsqbk', 'sweep_param_path': '/Data/harold.ngoupeyou/cheese_classification_challenge/wandb/sweep-x13yps6n/config-8hscsqbk.yaml'}
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'train.py', 'program_abspath': '/Data/harold.ngoupeyou/cheese_classification_challenge/train.py', 'program': '/Data/harold.ngoupeyou/cheese_classification_challenge/train.py'}
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_init.py:_log_setup():520] Logging user logs to /Data/harold.ngoupeyou/cheese_classification_challenge/wandb/run-20240518_213130-8hscsqbk/logs/debug.log
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_init.py:_log_setup():521] Logging internal logs to /Data/harold.ngoupeyou/cheese_classification_challenge/wandb/run-20240518_213130-8hscsqbk/logs/debug-internal.log
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_init.py:init():560] calling init triggers
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_init.py:init():567] wandb.init called with sweep_config: {'epochs': 35, 'lr': 0.00011849631618732372}
config: {'model': {'instance': {'_target_': 'models.dinov2.DinoV2Finetune', 'num_classes': 37, 'frozen': True, 'unfreeze_last_layer': True}, 'name': 'DINOV2'}, 'dataset': {'train_transform': {'_target_': 'torchvision.transforms.Compose', 'transforms': [{'_target_': 'torchvision.transforms.RandomResizedCrop', 'size': [224, 224]}, {'_target_': 'torchvision.transforms.RandomRotation', 'degrees': 30}, {'_target_': 'torchvision.transforms.RandomHorizontalFlip'}, {'_target_': 'torchvision.transforms.ColorJitter', 'brightness': 0.4, 'contrast': 0.4, 'saturation': 0.2, 'hue': 0.1}, {'_target_': 'torchvision.transforms.RandomAffine', 'degrees': 0, 'translate': [0.1, 0.1]}, {'_target_': 'torchvision.transforms.ToTensor'}, {'_target_': 'torchvision.transforms.Normalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}]}, 'test_transform': {'_target_': 'torchvision.transforms.Compose', 'transforms': [{'_target_': 'torchvision.transforms.Resize', 'size': [224, 224]}, {'_target_': 'torchvision.transforms.ToTensor'}, {'_target_': 'torchvision.transforms.Normalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}]}, 'name': 'advanced_prompt', 'num_classes': 37, 'batch_size': 128, 'num_workers': 8, 'train_path': '/Data/harold.ngoupeyou/cheese_classification_challenge/dataset/train/advanced_prompt_advanced_models/00-v2', 'real_images_val_path': '/Data/harold.ngoupeyou/cheese_classification_challenge/dataset/val_simplified', 'test_path': '/Data/harold.ngoupeyou/cheese_classification_challenge/dataset/test'}, 'optim': {'_target_': 'torch.optim.AdamW', 'lr': 1e-05, 'betas': [0.9, 0.999]}, 'loss_fn': {'_partial_': True, '_target_': 'torch.nn.functional.cross_entropy', 'reduction': 'mean', 'label_smoothing': 0.05}, 'datamodule': {'_target_': 'data.datamodule.DataModule', 'train_dataset_path': '/Data/harold.ngoupeyou/cheese_classification_challenge/dataset/train/advanced_prompt_advanced_models/00-v2', 'real_images_val_path': '/Data/harold.ngoupeyou/cheese_classification_challenge/dataset/val_simplified', 'train_transform': {'_target_': 'torchvision.transforms.Compose', 'transforms': [{'_target_': 'torchvision.transforms.RandomResizedCrop', 'size': [224, 224]}, {'_target_': 'torchvision.transforms.RandomRotation', 'degrees': 30}, {'_target_': 'torchvision.transforms.RandomHorizontalFlip'}, {'_target_': 'torchvision.transforms.ColorJitter', 'brightness': 0.4, 'contrast': 0.4, 'saturation': 0.2, 'hue': 0.1}, {'_target_': 'torchvision.transforms.RandomAffine', 'degrees': 0, 'translate': [0.1, 0.1]}, {'_target_': 'torchvision.transforms.ToTensor'}, {'_target_': 'torchvision.transforms.Normalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}]}, 'val_transform': {'_target_': 'torchvision.transforms.Compose', 'transforms': [{'_target_': 'torchvision.transforms.Resize', 'size': [224, 224]}, {'_target_': 'torchvision.transforms.ToTensor'}, {'_target_': 'torchvision.transforms.Normalize', 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225]}]}, 'batch_size': 32, 'num_workers': 8}, 'data_dir': '/Data/harold.ngoupeyou/cheese_classification_challenge/dataset', 'root_dir': '/Data/harold.ngoupeyou/cheese_classification_challenge', 'checkpoint_path': '/Data/harold.ngoupeyou/cheese_classification_challenge/checkpoints/DINOV2_advanced_prompt.pt', 'experiment_name': 'DINOV2_advanced_prompt', 'epochs': 10}
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_init.py:init():610] starting backend
2024-05-18 21:31:30,190 INFO    MainThread:491237 [wandb_init.py:init():614] setting up manager
2024-05-18 21:31:30,195 INFO    MainThread:491237 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-05-18 21:31:30,196 INFO    MainThread:491237 [wandb_init.py:init():622] backend started and connected
2024-05-18 21:31:30,205 INFO    MainThread:491237 [wandb_run.py:_config_callback():1376] config_cb None None {'epochs': 35, 'lr': 0.00011849631618732372}
2024-05-18 21:31:30,205 INFO    MainThread:491237 [wandb_init.py:init():711] updated telemetry
2024-05-18 21:31:30,207 INFO    MainThread:491237 [wandb_init.py:init():744] communicating run to backend with 90.0 second timeout
2024-05-18 21:31:30,559 INFO    MainThread:491237 [wandb_run.py:_on_init():2396] communicating current version
2024-05-18 21:31:30,637 INFO    MainThread:491237 [wandb_run.py:_on_init():2405] got version response 
2024-05-18 21:31:30,637 INFO    MainThread:491237 [wandb_init.py:init():795] starting run threads in backend
2024-05-18 21:31:33,409 INFO    MainThread:491237 [wandb_run.py:_console_start():2374] atexit reg
2024-05-18 21:31:33,409 INFO    MainThread:491237 [wandb_run.py:_redirect():2229] redirect: wrap_raw
2024-05-18 21:31:33,410 INFO    MainThread:491237 [wandb_run.py:_redirect():2294] Wrapping output streams.
2024-05-18 21:31:33,410 INFO    MainThread:491237 [wandb_run.py:_redirect():2319] Redirects installed.
2024-05-18 21:31:33,410 INFO    MainThread:491237 [wandb_init.py:init():838] run started, returning control to user process
2024-05-18 21:32:49,127 INFO    MainThread:491237 [wandb_run.py:_config_callback():1376] config_cb ('_wandb', 'visualize', 'synthetic_val/confusion_matrix') {'panel_type': 'Vega2', 'panel_config': {'panelDefId': 'wandb/confusion_matrix/v1', 'fieldSettings': {'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, 'stringSettings': {'title': ''}, 'transform': {'name': 'tableWithLeafColNames'}, 'userQuery': {'queryFields': [{'name': 'runSets', 'args': [{'name': 'runSets', 'value': '${runSets}'}], 'fields': [{'name': 'id', 'fields': []}, {'name': 'name', 'fields': []}, {'name': '_defaultColorIndex', 'fields': []}, {'name': 'summaryTable', 'args': [{'name': 'tableKey', 'value': 'synthetic_val/confusion_matrix_table'}], 'fields': []}]}]}}} None
2024-05-18 21:32:49,127 INFO    MainThread:491237 [wandb_run.py:_config_callback():1376] config_cb ('_wandb', 'visualize', 'real_val/confusion_matrix') {'panel_type': 'Vega2', 'panel_config': {'panelDefId': 'wandb/confusion_matrix/v1', 'fieldSettings': {'Actual': 'Actual', 'Predicted': 'Predicted', 'nPredictions': 'nPredictions'}, 'stringSettings': {'title': ''}, 'transform': {'name': 'tableWithLeafColNames'}, 'userQuery': {'queryFields': [{'name': 'runSets', 'args': [{'name': 'runSets', 'value': '${runSets}'}], 'fields': [{'name': 'id', 'fields': []}, {'name': 'name', 'fields': []}, {'name': '_defaultColorIndex', 'fields': []}, {'name': 'summaryTable', 'args': [{'name': 'tableKey', 'value': 'real_val/confusion_matrix_table'}], 'fields': []}]}]}}} None
2024-05-18 21:34:00,932 WARNING MsgRouterThr:491237 [router.py:message_loop():77] message_loop has been closed
